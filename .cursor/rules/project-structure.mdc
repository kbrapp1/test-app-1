---
description: 
globs: 
alwaysApply: false
---
# Project Structure Overview

This is a **Next.js 13+ App Router** application with **Domain-Driven Design (DDD)** patterns, following enterprise-level organization.

## Key Architecture Patterns

- **Feature-Based Organization**: Code is grouped by business domain (DAM, TTS, Auth, Marketing Automation, etc.)
- **DDD in DAM Module**: Fully migrated - Domain entities, repositories, and use cases properly separated
- **Progressive DDD Migration**: Other domains will be migrated to DDD patterns later
- **Co-located Tests**: Tests live alongside the code they test
- **Clean Architecture**: Clear separation between UI, business logic, and data layers

## Navigation Guide

### ğŸ¯ Core Business Features
```
app/(protected)/          # Protected application routes
â”œâ”€â”€ dam/                  # Digital Asset Management (DDD-migrated)
â”œâ”€â”€ ai-playground/        # AI features (TTS, chatbot)
â”‚   â”œâ”€â”€ chatbot/         # AI chatbot interface
â”‚   â””â”€â”€ text-to-speech/  # Text-to-speech playground
â”œâ”€â”€ marketing-automation/ # CRM-like features
â”‚   â”œâ”€â”€ contacts/        # Contact management
â”‚   â”œâ”€â”€ customers/       # Customer management
â”‚   â”œâ”€â”€ leads/           # Lead tracking
â”‚   â””â”€â”€ opportunities/   # Sales opportunities
â”œâ”€â”€ settings/            # User/org settings
â”‚   â”œâ”€â”€ profile/         # User profile settings
â”‚   â”œâ”€â”€ security/        # Security settings
â”‚   â”œâ”€â”€ org-roles/       # Organization role management
â”‚   â””â”€â”€ danger/          # Dangerous operations
â”œâ”€â”€ team/                # Team management
â”œâ”€â”€ documents/           # Document management
â”‚   â””â”€â”€ notes/           # Note-taking system
â”œâ”€â”€ playbooks/           # Business playbooks
â”œâ”€â”€ reporting/           # Analytics and reporting
â””â”€â”€ integrations/        # Third-party integrations
```

### ğŸ§© Reusable Components
```
components/
â”œâ”€â”€ ui/                  # Base UI components (shadcn/ui)
â”œâ”€â”€ tts/                 # Text-to-speech components
â”œâ”€â”€ auth/                # Authentication forms
â”œâ”€â”€ team/                # Team management components
â”œâ”€â”€ settings/            # Settings page components
â”œâ”€â”€ forms/               # Reusable form components
â”‚   â””â”€â”€ fields/          # Form field components
â”œâ”€â”€ notes/               # Note-taking components
â””â”€â”€ providers/           # React context providers
```

### âš¡ Business Logic Layer
```
lib/
â”œâ”€â”€ actions/             # Server actions (Next.js)
â”‚   â”œâ”€â”€ dam/             # DAM server actions
â”‚   â”œâ”€â”€ members.ts       # Member management actions
â”‚   â”œâ”€â”€ team.ts          # Team actions
â”‚   â””â”€â”€ tts.ts           # TTS actions
â”œâ”€â”€ dam/                 # DDD-structured DAM domain (MIGRATED)
â”‚   â”œâ”€â”€ domain/          # Entities, repositories, value objects
â”‚   â”œâ”€â”€ application/     # Use cases, services, DTOs
â”‚   â”œâ”€â”€ infrastructure/  # Supabase implementations
â”‚   â”œâ”€â”€ presentation/    # React components, hooks, types
â”‚   â”œâ”€â”€ types/           # Domain-specific TypeScript types
â”‚   â””â”€â”€ index.ts         # Public API exports
â”œâ”€â”€ usecases/            # Use cases for other domains
â”‚   â””â”€â”€ tts/             # TTS business logic (pre-DDD)
â”œâ”€â”€ services/            # External service integrations
â”œâ”€â”€ schemas/             # Validation schemas
â”œâ”€â”€ auth/                # Authentication & authorization
â”œâ”€â”€ hooks/               # Custom React hooks
â””â”€â”€ forms/               # Form utilities and validation
```

### ğŸ—„ï¸ Data & API Layer
```
app/api/                 # REST API endpoints
â”œâ”€â”€ dam/                 # DAM API routes
â”‚   â”œâ”€â”€ asset/           # Asset operations
â”‚   â”œâ”€â”€ folders/         # Folder operations
â”‚   â””â”€â”€ upload/          # File upload handling
â”œâ”€â”€ team/                # Team management API
â””â”€â”€ profile/             # User profile API
supabase/                # Database schema & edge functions
â”œâ”€â”€ functions/           # Supabase Edge Functions
â””â”€â”€ migrations/          # Database migrations
```

### ğŸ“š Documentation & Configuration
```
docs/                    # Comprehensive feature documentation
â”œâ”€â”€ DAM/                 # DAM feature docs and build steps
â”œâ”€â”€ text-to-speech/      # TTS feature documentation
â”œâ”€â”€ multi-tenant/        # Multi-tenancy implementation
â”œâ”€â”€ roles/               # Role system documentation
â””â”€â”€ general/             # General platform documentation
```

## Quick Start Navigation

1. **New Feature**: Start in `app/(protected)/[feature]/`
2. **Reusable UI**: Check `components/ui/` first, then domain-specific components
3. **Business Logic**: 
   - **DAM**: Use `lib/dam/` (DDD structure)
   - **Other domains**: Check `lib/actions/` or `lib/usecases/`
4. **API Integration**: Check `lib/services/` or `app/api/`
5. **Database Changes**: Start in `supabase/migrations/`
6. **Documentation**: Check `docs/[domain]/` for feature-specific docs

## Domain-Specific Patterns

### DAM (Digital Asset Management) âœ… DDD-Migrated
- Follows **Clean Architecture** with full DDD implementation
- **Domain Layer**: `lib/dam/domain/` (entities, repositories, value objects)
- **Application Layer**: `lib/dam/application/` (use cases, services, DTOs)
- **Infrastructure Layer**: `lib/dam/infrastructure/` (Supabase implementations)
- **Presentation Layer**: `lib/dam/presentation/` (React components, hooks, domain types)
- **Types Layer**: `lib/dam/types/` (Domain-specific TypeScript definitions)
- **Public API**: `lib/dam/index.ts` (Centralized exports for clean imports)

### Text-to-Speech (TTS) ğŸ”„ Legacy Structure (Migration Planned)
- **Components**: `components/tts/`
- **Business Logic**: `lib/usecases/tts/` (use case pattern)
- **Service Integration**: `lib/services/elevenlabsService.ts`
- **Server Actions**: `lib/actions/tts.ts`

### Authentication & Authorization ğŸ”„ Legacy Structure (Migration Planned)
- **Middleware**: `lib/auth/middleware.ts`
- **Server Actions**: `lib/auth/server-action.ts`
- **Components**: `components/auth/`
- **Authorization Logic**: `lib/auth/authorization.ts`

### Team Management ğŸ”„ Legacy Structure (Migration Planned)
- **Components**: `components/team/`, `components/settings/`
- **Server Actions**: `lib/actions/team.ts`, `lib/actions/members.ts`
- **API Routes**: `app/api/team/`

### Notes System ğŸ”„ Legacy Structure (Migration Planned)
- **Components**: `components/notes/`
- **Page Logic**: `app/(protected)/documents/notes/`
- **Types**: `types/notes.ts`

## File Naming Conventions

- **Components**: PascalCase (`AssetGallery.tsx`, `TtsInterface.tsx`)
- **Pages**: lowercase (`page.tsx`, `layout.tsx`)
- **Utilities**: camelCase (`folderPickerUtils.ts`, `ttsHistoryUtils.ts`)
- **Tests**: `.test.tsx` or `.test.ts`
- **Types**: `.types.ts`
- **Server Actions**: `[domain].actions.ts`
- **Use Cases**: `[UseCase]UseCase.ts`

## Best Practices Followed

âœ… **Co-located Tests**: Tests next to implementation  
âœ… **Feature Isolation**: Each domain is self-contained  
âœ… **Type Safety**: Comprehensive TypeScript usage  
âœ… **Clean Separation**: UI, business logic, and data layers separated  
âœ… **Documentation**: Extensive docs for complex features in `docs/`  
âœ… **DDD in DAM**: Proper domain-driven design implementation  
âœ… **Progressive Migration**: Gradual migration to DDD patterns  

## Migration Status & Future Plans

### âœ… Completed Migrations
- **DAM Domain**: Fully migrated to DDD architecture
- **Multi-tenant Support**: Integrated across the platform
- **Role System**: Complete role-based access control
- **Team Management**: Full team member management system

### ğŸ”„ Planned DDD Migrations
The following domains are candidates for DDD migration:

1. **Text-to-Speech (TTS)**
   - Current: Use case pattern in `lib/usecases/tts/`
   - Target: Full DDD with `lib/tts/domain|application|infrastructure/`

2. **Authentication & Authorization**
   - Current: Mixed in `lib/auth/`
   - Target: DDD structure with proper domain separation

3. **Team Management**
   - Current: Server actions and components
   - Target: DDD with team domain modeling

4. **Marketing Automation**
   - Current: Basic page structure
   - Target: Full CRM domain with DDD

5. **Reporting & Analytics**
   - Current: Basic implementation
   - Target: Analytics domain with DDD

## Areas for Future Enhancement

Consider these optimizations as the codebase grows:

- **Complete DDD Migration**: Migrate remaining domains to DDD structure
- **Barrel Exports**: Add `index.ts` files in component folders for cleaner imports
- **Shared Types**: Consolidate cross-domain types in dedicated folders
- **E2E Tests**: Add Playwright/Cypress tests in a dedicated `e2e/` folder
- **API Documentation**: Generate API docs from the growing API layer
- **Component Library**: Formalize the component system with Storybook
- **Performance Monitoring**: Add performance tracking for the growing feature set

---

*This structure supports both rapid feature development and long-term maintainability, with a clear migration path toward full DDD architecture.*